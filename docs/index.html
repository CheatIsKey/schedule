<!DOCTYPE html>
<html>
<head>
    <title>일정 관리 프로젝트 API</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
            href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:300,400,700"
            rel="stylesheet"
    />
    <style>
        body { margin: 0; padding: 0; }
    </style>
</head>
<body>
<div id="redoc-container"></div>

<script src="https://cdn.jsdelivr.net/npm/redoc@2.0.0-rc.77/bundles/redoc.standalone.js"></script>

<script>
    // 데이터 정의
    const spec = {
        "openapi": "3.0.1",
        "info": {
            "title": "일정 관리 프로젝트 API",
            "description": "일정 등록, 조회, 수정, 삭제 기능을 제공하는 API 명세서입니다.",
            "version": "1.0.0"
        },
        "servers": [
            {
                "url": "http://localhost:8080",
                "description": "Local Server"
            }
        ],
        "paths": {
            "/api/{id}": {
                "get": {
                    "tags": ["schedule-controller"],
                    "summary": "일정 단건 조회",
                    "operationId": "getScheduleAndComment",
                    "parameters": [
                        {
                            "name": "id",
                            "in": "path",
                            "description": "조회할 일정 ID",
                            "required": true,
                            "schema": { "type": "integer", "format": "int64" }
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "성공 (일정 및 댓글 조회)",
                            "content": {
                                "*/*": {
                                    "schema": { "$ref": "#/components/schemas/ScheduleAndCommentReadResponseDto" }
                                }
                            }
                        },
                        "404": {
                            "description": "실패: 해당 ID의 일정이 존재하지 않음",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        }
                    }
                },
                "put": {
                    "tags": ["schedule-controller"],
                    "summary": "일정 수정",
                    "operationId": "updateSchedule",
                    "parameters": [
                        {
                            "name": "id",
                            "in": "path",
                            "description": "수정할 일정 ID",
                            "required": true,
                            "schema": { "type": "integer", "format": "int64" }
                        }
                    ],
                    "requestBody": {
                        "description": "수정할 내용 및 비밀번호",
                        "content": {
                            "application/json": {
                                "schema": { "$ref": "#/components/schemas/ScheduleUpdateRequestDto" }
                            }
                        },
                        "required": true
                    },
                    "responses": {
                        "200": {
                            "description": "성공 (수정 완료)",
                            "content": {
                                "*/*": {
                                    "schema": { "$ref": "#/components/schemas/ScheduleUpdateResponseDto" }
                                }
                            }
                        },
                        "401": {
                            "description": "실패: 비밀번호 불일치",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        },
                        "404": {
                            "description": "실패: 해당 ID의 일정이 존재하지 않음",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        }
                    }
                },
                "delete": {
                    "tags": ["schedule-controller"],
                    "summary": "일정 삭제",
                    "operationId": "deleteSchedule",
                    "parameters": [
                        {
                            "name": "id",
                            "in": "path",
                            "description": "삭제할 일정 ID",
                            "required": true,
                            "schema": { "type": "integer", "format": "int64" }
                        }
                    ],
                    "requestBody": {
                        "description": "삭제 권한 확인용 비밀번호",
                        "content": {
                            "application/json": {
                                "schema": { "$ref": "#/components/schemas/ScheduleDeleteResponseDto" }
                            }
                        },
                        "required": true
                    },
                    "responses": {
                        "200": { "description": "성공 (삭제 완료)" },
                        "401": {
                            "description": "실패: 비밀번호 불일치",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        },
                        "404": {
                            "description": "실패: 해당 ID의 일정이 존재하지 않음",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        }
                    }
                }
            },
            "/api": {
                "get": {
                    "tags": ["schedule-controller"],
                    "summary": "전체 일정 조회",
                    "operationId": "getSchedules",
                    "parameters": [
                        {
                            "name": "name",
                            "in": "query",
                            "description": "작성자 이름으로 필터링 (선택)",
                            "required": false,
                            "schema": { "type": "string" }
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "content": {
                                "*/*": {
                                    "schema": {
                                        "type": "array",
                                        "items": { "$ref": "#/components/schemas/ScheduleReadAllResponseDto" }
                                    }
                                }
                            }
                        },
                        "500": {
                            "description": "서버 내부 오류",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        }
                    }
                },
                "post": {
                    "tags": ["schedule-controller"],
                    "summary": "일정 생성",
                    "operationId": "createSchedule",
                    "requestBody": {
                        "content": {
                            "application/json": {
                                "schema": { "$ref": "#/components/schemas/ScheduleCreateRequestDto" }
                            }
                        },
                        "required": true
                    },
                    "responses": {
                        "201": {
                            "description": "Created (생성 성공)",
                            "content": {
                                "*/*": {
                                    "schema": { "$ref": "#/components/schemas/ScheduleCreateResponseDto" }
                                }
                            }
                        },
                        "400": {
                            "description": "실패: 잘못된 요청 (필수값 누락 등)",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        }
                    }
                }
            },
            "/api/{scheduleId}": {
                "post": {
                    "tags": ["comment-controller"],
                    "summary": "댓글 생성",
                    "operationId": "createComment",
                    "parameters": [
                        {
                            "name": "scheduleId",
                            "in": "path",
                            "description": "댓글을 달 일정 ID",
                            "required": true,
                            "schema": { "type": "integer", "format": "int64" }
                        }
                    ],
                    "requestBody": {
                        "content": {
                            "application/json": {
                                "schema": { "$ref": "#/components/schemas/CommentCreateRequestDto" }
                            }
                        },
                        "required": true
                    },
                    "responses": {
                        "201": {
                            "description": "Created (댓글 등록 성공)",
                            "content": {
                                "*/*": {
                                    "schema": { "$ref": "#/components/schemas/CommentCreateResponseDto" }
                                }
                            }
                        },
                        "400": {
                            "description": "실패: 댓글 제한(10개) 초과 또는 입력값 오류",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        },
                        "404": {
                            "description": "실패: 해당 ID의 일정이 존재하지 않음",
                            "content": {
                                "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } }
                            }
                        }
                    }
                }
            }
        },
        "components": {
            "schemas": {
                "ErrorResponse": {
                    "type": "object",
                    "properties": {
                        "message": { "type": "string", "example": "에러 메시지입니다." },
                        "statusCode": { "type": "integer", "example": 400 }
                    }
                },
                "ScheduleUpdateRequestDto": {
                    "type": "object",
                    "properties": {
                        "title": { "type": "string" },
                        "content": { "type": "string" },
                        "name": { "type": "string" },
                        "password": { "type": "string" }
                    }
                },
                "ScheduleUpdateResponseDto": {
                    "type": "object",
                    "properties": {
                        "id": { "type": "integer", "format": "int64" },
                        "title": { "type": "string" },
                        "name": { "type": "string" },
                        "content": { "type": "string" },
                        "createdAt": { "type": "string", "format": "date-time" },
                        "modifiedAt": { "type": "string", "format": "date-time" }
                    }
                },
                "ScheduleCreateRequestDto": {
                    "type": "object",
                    "properties": {
                        "title": { "type": "string" },
                        "content": { "type": "string" },
                        "name": { "type": "string" },
                        "password": { "type": "string" }
                    }
                },
                "ScheduleCreateResponseDto": {
                    "type": "object",
                    "properties": {
                        "id": { "type": "integer", "format": "int64" },
                        "title": { "type": "string" },
                        "name": { "type": "string" },
                        "content": { "type": "string" },
                        "createdAt": { "type": "string", "format": "date-time" },
                        "modifiedAt": { "type": "string", "format": "date-time" }
                    }
                },
                "CommentCreateRequestDto": {
                    "type": "object",
                    "properties": {
                        "name": { "type": "string" },
                        "content": { "type": "string" },
                        "password": { "type": "string" }
                    }
                },
                "CommentCreateResponseDto": {
                    "type": "object",
                    "properties": {
                        "id": { "type": "integer", "format": "int64" },
                        "scheduleId": { "type": "integer", "format": "int64" },
                        "name": { "type": "string" },
                        "content": { "type": "string" },
                        "createdAt": { "type": "string", "format": "date-time" },
                        "modifiedAt": { "type": "string", "format": "date-time" }
                    }
                },
                "ScheduleReadAllResponseDto": {
                    "type": "object",
                    "properties": {
                        "id": { "type": "integer", "format": "int64" },
                        "title": { "type": "string" },
                        "name": { "type": "string" },
                        "content": { "type": "string" },
                        "createdAt": { "type": "string", "format": "date-time" },
                        "modifiedAt": { "type": "string", "format": "date-time" }
                    }
                },
                "CommentResponseDto": {
                    "type": "object",
                    "properties": {
                        "id": { "type": "integer", "format": "int64" },
                        "content": { "type": "string" },
                        "name": { "type": "string" },
                        "createdAt": { "type": "string", "format": "date-time" },
                        "modifiedAt": { "type": "string", "format": "date-time" }
                    }
                },
                "ScheduleAndCommentReadResponseDto": {
                    "type": "object",
                    "properties": {
                        "id": { "type": "integer", "format": "int64" },
                        "title": { "type": "string" },
                        "name": { "type": "string" },
                        "content": { "type": "string" },
                        "createdAt": { "type": "string", "format": "date-time" },
                        "modifiedAt": { "type": "string", "format": "date-time" },
                        "comments": {
                            "type": "array",
                            "items": { "$ref": "#/components/schemas/CommentResponseDto" }
                        }
                    }
                },
                "ScheduleDeleteResponseDto": {
                    "type": "object",
                    "properties": {
                        "password": { "type": "string" }
                    }
                }
            }
        }
    };

    // 실행부: 안전하게 로딩 후 실행
    window.addEventListener('load', function() {
        try {
            Redoc.init(
                spec,
                { scrollYOffset: 50 },
                document.getElementById('redoc-container')
            );
            console.log("Redoc initialized successfully!");
        } catch (e) {
            console.error("Redoc initialization failed:", e);
            alert("문서를 불러오는 중 오류가 발생했습니다. 개발자 도구(F12)를 확인해주세요.");
        }
    });
</script>
</body>
</html>